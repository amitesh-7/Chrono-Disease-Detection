<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Disease Classification AI</title>
    <style>
      :root {
        --bg-1: #667eea;
        --bg-2: #764ba2;
        --glass-bg: rgba(255, 255, 255, 0.06);
        --card-bg: rgba(255, 255, 255, 0.78);
        --muted: #6b7280;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      html,
      body {
        height: 100%;
      }
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, var(--bg-1), var(--bg-2));
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        padding: 28px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        border-radius: 18px;
        overflow: hidden;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.06),
          rgba(255, 255, 255, 0.03)
        );
        box-shadow: 0 8px 30px rgba(6, 10, 20, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(8px) saturate(120%);
      }

      .header {
        padding: 28px 32px;
        text-align: left;
        display: flex;
        flex-direction: column;
        gap: 6px;
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0.04),
          rgba(255, 255, 255, 0.02)
        );
        border-bottom: 1px solid rgba(255, 255, 255, 0.04);
      }

      .header h1 {
        font-size: 1.9rem;
        color: #fff;
        letter-spacing: 0.2px;
      }
      .header p {
        color: rgba(255, 255, 255, 0.85);
        font-size: 0.98rem;
      }

      .content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 28px;
        padding: 30px;
      }

      /* glass card */
      .form-section,
      .result-section {
        padding: 22px;
        border-radius: 12px;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.6),
          rgba(255, 255, 255, 0.55)
        );
        box-shadow: 0 6px 18px rgba(16, 24, 40, 0.08);
        border: 1px solid rgba(15, 23, 42, 0.04);
      }

      h2 {
        color: var(--bg-1);
        margin-bottom: 16px;
        font-size: 1.25rem;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 14px;
      }
      .form-group {
        margin-bottom: 12px;
      }
      label {
        display: block;
        margin-bottom: 6px;
        color: #111827;
        font-weight: 600;
        font-size: 0.88rem;
      }

      input[type="number"],
      select {
        width: 100%;
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid rgba(15, 23, 42, 0.06);
        background: rgba(255, 255, 255, 0.9);
        font-size: 0.95rem;
        color: #0f172a;
      }
      input[type="number"]:focus,
      select:focus {
        outline: none;
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.08);
      }

      .symptom-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        margin-top: 12px;
      }
      .symptom-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 8px;
      }
      .symptom-item label {
        font-size: 0.88rem;
        color: #111827;
      }
      .symptom-item input {
        width: 64px;
        padding: 6px;
        border-radius: 8px;
      }

      .btn {
        width: 100%;
        padding: 14px;
        border-radius: 12px;
        border: none;
        cursor: pointer;
        font-weight: 700;
        color: white;
        background: linear-gradient(90deg, var(--bg-1), var(--bg-2));
        box-shadow: 0 8px 30px rgba(118, 75, 162, 0.18);
        transition: transform 0.14s ease;
      }
      .btn:hover {
        transform: translateY(-3px);
      }

      .result-card {
        background: transparent;
        padding: 18px;
        border-radius: 10px;
        margin-bottom: 14px;
        border-left: 4px solid rgba(102, 126, 234, 0.18);
      }
      .result-card h3 {
        color: var(--bg-1);
        margin-bottom: 8px;
      }

      .prediction {
        font-size: 1.8rem;
        font-weight: 800;
        color: var(--bg-2);
        text-transform: capitalize;
      }
      .confidence {
        font-weight: 700;
        color: var(--bg-1);
      }

      .probabilities {
        margin-top: 12px;
      }
      .prob-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 8px 0;
        border-bottom: 1px solid rgba(15, 23, 42, 0.04);
      }
      .prob-bar {
        flex: 1;
        height: 8px;
        background: rgba(15, 23, 42, 0.06);
        border-radius: 999px;
        overflow: hidden;
      }
      .prob-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--bg-1), var(--bg-2));
        transition: width 0.5s;
      }

      .loading {
        display: none;
        text-align: center;
        padding: 30px;
      }
      .spinner {
        border: 4px solid rgba(0, 0, 0, 0.06);
        border-top: 4px solid rgba(102, 126, 234, 0.9);
        border-radius: 50%;
        width: 44px;
        height: 44px;
        animation: spin 1s linear infinite;
        margin: 0 auto 12px;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .error {
        background: #ffeef0;
        color: #b91c1c;
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 12px;
        display: none;
      }
      .info-box {
        background: linear-gradient(
          180deg,
          rgba(99, 102, 241, 0.08),
          rgba(255, 255, 255, 0.02)
        );
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 14px;
        color: var(--muted);
        border-left: 4px solid rgba(99, 102, 241, 0.12);
      }

      .model-selector {
        display: flex;
        gap: 10px;
        margin-bottom: 18px;
      }
      .model-btn {
        flex: 1;
        padding: 10px;
        border-radius: 10px;
        border: 1px solid rgba(15, 23, 42, 0.06);
        background: rgba(255, 255, 255, 0.9);
        cursor: pointer;
        font-weight: 700;
        color: #0f172a;
      }
      .model-btn.active {
        background: linear-gradient(90deg, var(--bg-1), var(--bg-2));
        color: #fff;
        box-shadow: 0 8px 28px rgba(102, 126, 234, 0.12);
      }

      @media (max-width: 968px) {
        .content {
          grid-template-columns: 1fr;
        }
        .form-row {
          grid-template-columns: 1fr;
        }
        .symptom-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>Disease Classification AI</h1>
        <p>
          Advanced ML-powered diagnostic assistance using Random Forest &
          XGBoost
        </p>
      </div>

      <div class="content">
        <div class="form-section">
          <h2>Patient Information</h2>

          <div class="info-box">
            <strong>Symptom Severity:</strong> 0 = None, 1 = Mild, 2 = Moderate,
            3 = Severe
          </div>

          <div class="model-selector">
            <button class="model-btn active" data-model="xgboost">
              XGBoost (99.96% Accuracy)
            </button>
            <button class="model-btn" data-model="randomforest">
              Random Forest (97% Accuracy)
            </button>
          </div>

          <form id="predictionForm">
            <div class="form-row">
              <div class="form-group">
                <label for="age">Age</label>
                <input
                  type="number"
                  id="age"
                  min="1"
                  max="120"
                  value="35"
                  required
                />
              </div>
              <div class="form-group">
                <label for="gender">Gender</label>
                <select id="gender" required>
                  <option value="male">Male</option>
                  <option value="female">Female</option>
                </select>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="smoker">Smoker</label>
                <select id="smoker" required>
                  <option value="0">No</option>
                  <option value="1">Yes</option>
                </select>
              </div>
              <div class="form-group">
                <label for="heart_rate">Heart Rate (bpm)</label>
                <input
                  type="number"
                  id="heart_rate"
                  min="40"
                  max="200"
                  value="75"
                  required
                />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="blood_pressure">Blood Pressure (systolic)</label>
                <input
                  type="number"
                  id="blood_pressure"
                  min="60"
                  max="200"
                  value="120"
                  required
                />
              </div>
              <div class="form-group">
                <label for="cholesterol_level">Cholesterol Level (mg/dL)</label>
                <input
                  type="number"
                  id="cholesterol_level"
                  min="100"
                  max="400"
                  value="200"
                  required
                />
              </div>
            </div>

            <h3 style="margin: 20px 0 10px; color: #667eea">
              Symptoms (0-3 Scale)
            </h3>
            <div class="symptom-grid" id="symptomGrid">
              <!-- Symptoms will be dynamically generated -->
            </div>

            <button type="submit" class="btn">Analyze & Predict Disease</button>
          </form>
        </div>

        <div class="result-section">
          <h2>Prediction Results</h2>

          <div class="error" id="errorMsg"></div>

          <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Analyzing patient data...</p>
          </div>

          <div id="results" style="display: none">
            <div class="result-card">
              <h3>Predicted Disease</h3>
              <div class="prediction" id="prediction">-</div>
              <div class="confidence">
                Confidence: <span id="confidence">-</span>%
              </div>
              <div style="margin-top: 10px; color: #666; font-size: 0.9em">
                Model: <span id="modelUsed">-</span>
              </div>
            </div>

            <div class="result-card">
              <h3>All Disease Probabilities</h3>
              <div class="probabilities" id="probabilities">
                <!-- Probabilities will be inserted here -->
              </div>
            </div>
          </div>

          <div
            style="
              margin-top: 20px;
              padding: 15px;
              background: #fff3cd;
              border-radius: 8px;
              font-size: 0.85em;
            "
          >
            <strong>Medical Disclaimer:</strong> This is an AI prediction tool
            for educational purposes only. Always consult qualified healthcare
            professionals for medical diagnosis and treatment.
          </div>
        </div>
      </div>
    </div>

    <script>
      // Symptom list (40 symptoms)
      const symptoms = [
        "fever",
        "cough",
        "fatigue",
        "shortness_of_breath",
        "headache",
        "runny_nose",
        "sore_throat",
        "chest_pain",
        "body_ache",
        "nausea",
        "vomiting",
        "diarrhea",
        "dizziness",
        "chills",
        "loss_of_smell",
        "loss_of_taste",
        "wheezing",
        "rash",
        "eye_irritation",
        "ear_pain",
        "sweating",
        "joint_pain",
        "abdominal_pain",
        "back_pain",
        "blurred_vision",
        "dry_cough",
        "wet_cough",
        "sinus_pressure",
        "sneezing",
        "rapid_heartbeat",
        "slow_heartbeat",
        "dehydration",
        "loss_of_appetite",
        "sleep_disturbance",
        "anxiety",
        "irritability",
        "muscle_spasm",
        "skin_redness",
        "itchiness",
        "breathing_difficulty",
      ];

      // Generate symptom inputs
      const symptomGrid = document.getElementById("symptomGrid");
      symptoms.forEach((symptom) => {
        const div = document.createElement("div");
        div.className = "symptom-item";
        div.innerHTML = `
                <label for="${symptom}">${symptom
          .replace(/_/g, " ")
          .replace(/\b\w/g, (l) => l.toUpperCase())}</label>
                <input type="number" id="${symptom}" min="0" max="3" value="0" required>
            `;
        symptomGrid.appendChild(div);
      });

      // Model selection
      let selectedModel = "xgboost";
      document.querySelectorAll(".model-btn").forEach((btn) => {
        btn.addEventListener("click", function () {
          document
            .querySelectorAll(".model-btn")
            .forEach((b) => b.classList.remove("active"));
          this.classList.add("active");
          selectedModel = this.dataset.model;
        });
      });

      // Form submission
      document
        .getElementById("predictionForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          // Hide error and results
          document.getElementById("errorMsg").style.display = "none";
          document.getElementById("results").style.display = "none";
          document.getElementById("loading").style.display = "block";

          // Collect form data
          const formData = {
            model: selectedModel,
            age: parseInt(document.getElementById("age").value),
            gender: document.getElementById("gender").value,
            smoker: parseInt(document.getElementById("smoker").value),
            heart_rate: parseInt(document.getElementById("heart_rate").value),
            blood_pressure: parseInt(
              document.getElementById("blood_pressure").value
            ),
            cholesterol_level: parseInt(
              document.getElementById("cholesterol_level").value
            ),
          };

          // Add symptoms
          symptoms.forEach((symptom) => {
            formData[symptom] = parseInt(
              document.getElementById(symptom).value
            );
          });

          try {
            // Send to API (Vercel serverless function)
            const response = await fetch("/api/predict", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(formData),
            });

            const result = await response.json();

            if (result.success) {
              // Display results
              document.getElementById("prediction").textContent =
                result.prediction.replace(/_/g, " ");
              document.getElementById("confidence").textContent =
                result.confidence.toFixed(2);
              document.getElementById("modelUsed").textContent =
                result.model_used.toUpperCase();

              // Display all probabilities
              const probDiv = document.getElementById("probabilities");
              probDiv.innerHTML = "";

              // Sort by probability
              const sortedProbs = Object.entries(result.all_probabilities).sort(
                (a, b) => b[1] - a[1]
              );

              sortedProbs.forEach(([disease, prob]) => {
                const item = document.createElement("div");
                item.className = "prob-item";
                item.innerHTML = `
                            <span style="min-width: 120px; font-weight: 500;">${disease.replace(
                              /_/g,
                              " "
                            )}</span>
                            <div class="prob-bar">
                                <div class="prob-fill" style="width: ${prob}%"></div>
                            </div>
                            <span style="min-width: 60px; text-align: right; font-weight: 600;">${prob.toFixed(
                              1
                            )}%</span>
                        `;
                probDiv.appendChild(item);
              });

              document.getElementById("results").style.display = "block";
            } else {
              throw new Error(result.error || "Prediction failed");
            }
          } catch (error) {
            document.getElementById("errorMsg").textContent =
              "Error: " + error.message;
            document.getElementById("errorMsg").style.display = "block";
          } finally {
            document.getElementById("loading").style.display = "none";
          }
        });
    </script>
  </body>
</html>
